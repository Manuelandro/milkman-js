//Copyright 2012, etc.

/**
 * almond 0.1.2 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//! moment.js
//! version : 2.10.6
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

(function(e,t){typeof define=="function"&&define.amd?define(["jquery"],t):e.milkman=t(e.$)})(this,function(e){var t,n,r;return function(e){function c(e,t){var n=t&&t.split("/"),r=o.map,i=r&&r["*"]||{},s,u,a,f,l,c,h,p,d,v;if(e&&e.charAt(0)==="."&&t){n=n.slice(0,n.length-1),e=n.concat(e.split("/"));for(p=0;v=e[p];p++)if(v===".")e.splice(p,1),p-=1;else if(v===".."){if(p===1&&(e[2]===".."||e[0]===".."))return!0;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((n||i)&&r){s=e.split("/");for(p=s.length;p>0;p-=1){u=s.slice(0,p).join("/");if(n)for(d=n.length;d>0;d-=1){a=r[n.slice(0,d).join("/")];if(a){a=a[u];if(a){f=a,l=p;break}}}if(f)break;!c&&i&&i[u]&&(c=i[u],h=p)}!f&&c&&(f=c,l=h),f&&(s.splice(0,l,f),e=s.join("/"))}return e}function h(t,n){return function(){return l.apply(e,a.call(arguments,0).concat([t,n]))}}function p(e){return function(t){return c(t,e)}}function d(e){return function(t){i[e]=t}}function v(t){if(s.hasOwnProperty(t)){var n=s[t];delete s[t],u[t]=!0,f.apply(e,n)}if(!i.hasOwnProperty(t))throw new Error("No "+t);return i[t]}function m(e,t){var n,r,i=e.indexOf("!");return i!==-1?(n=c(e.slice(0,i),t),e=e.slice(i+1),r=v(n),r&&r.normalize?e=r.normalize(e,p(t)):e=c(e,t)):e=c(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function g(e){return function(){return o&&o.config&&o.config[e]||{}}}var i={},s={},o={},u={},a=[].slice,f,l;f=function(t,n,r,o){var a=[],f,l,c,p,y,b;o=o||t;if(typeof r=="function"){n=!n.length&&r.length?["require","exports","module"]:n;for(b=0;b<n.length;b++){y=m(n[b],o),c=y.f;if(c==="require")a[b]=h(t);else if(c==="exports")a[b]=i[t]={},f=!0;else if(c==="module")l=a[b]={id:t,uri:"",exports:i[t],config:g(t)};else if(i.hasOwnProperty(c)||s.hasOwnProperty(c))a[b]=v(c);else if(y.p)y.p.load(y.n,h(o,!0),d(c),{}),a[b]=i[c];else if(!u[c])throw new Error(t+" missing "+c)}p=r.apply(i[t],a);if(t)if(l&&l.exports!==e&&l.exports!==i[t])i[t]=l.exports;else if(p!==e||!f)i[t]=p}else t&&(i[t]=r)},t=n=l=function(t,n,r,i){return typeof t=="string"?v(m(t,n).f):(t.splice||(o=t,n.splice?(t=n,n=r,r=null):t=e),n=n||function(){},i?f(e,t,n,r):setTimeout(function(){f(e,t,n,r)},15),l)},l.config=function(e){return o=e,l},r=function(e,t,n){t.splice||(n=t,t=[]),s[e]=[e,t,n]},r.amd={jQuery:!0}}(),r("../tools/almond",function(){}),r("milkman/Utils/constants",{API_URL_SERVER:"http://localhost/milkman/api",REDIRECT_URI:"redirect_uri",PUBLISHABLE_KEY:"publishable_key",SESSION_TOKEN:"session_token",PROPOSAL_ID:"proposal_id",HUB:"hub",MERCHANT:"merchant",INTERVAL_OF_INTEREST:"interval_of_interest",FIRST_AV_DAYS:"first_available_day",FIRST_AV_TIME:"first_available_time",DEFAULT_RANGE:"default_range",ADDRESSES:"addresses",defaultRange:"",requiredFields:{},range:[],data:{},intervals:[],discounts:[],merchant_details:"",STATUS:{SUCCESS:{OK_200:"OK: Success."},WARNING:{ADDRESS_ZERO_RESULTS:"We are not able to calculate lat-lng for some addresses.",ADDRESS_INCORRECT:"Some addresses are not acceptable, they missing required fields."},FAILURE:{NO_RESULTS_402:"No results.",BAD_REQUEST_400:"Bad Request: The request cannot be accepted. The accompanying error message explains why.",UNAUTHORIZED_401:"Unauthorized: Authentication credentials are missing or incorrect. The accompanying error message explains why.",RANGE_NOT_VALID:"Range is not valid.",RANGE_NOT_CORRECT:"Range is not in a correct form. Please check it."}},ERROR_MESSAGE:{NO_PUBKEY_URI:"You need to set publichable key and merchant URI before.",MISSING_IN_PARCEL:"Some required fields in Parcel's Cart are missing.",MISSING:"Some required fields are missing.",NEED_REQUIRED:"You need to set required fields before."},ERROR:{OK_200:"OK: Success.",NO_RESULTS_402:"No results.",BAD_REQUEST_400:"Bad Request: The request cannot be accepted. The accompanying error message explains why.",UNAUTHORIZED_401:"Unauthorized: Authentication credentials are missing or incorrect. The accompanying error message explains why."},SUCCESS:{OK_200:"OK: Success."}}),r("milkman/Private/makeUrlServer",["../../milkman/Utils/constants"],function(e){"use strict";return function(n){return e.API_URL_SERVER+n}}),r("milkman/Private/request",["jquery","../../milkman/Utils/constants"],function(e,t){"use strict";return function(r,i,s,o){var u=window.localStorage.getItem(t.SESSION_TOKEN);return e.ajax({url:r,type:i,data:s?s:null,dataType:"json",timeout:8e3,success:function(e,t,n){o({success:!0,data:e,textStatus:t,jqXHR:n})},error:function(e,t,n){o({success:!1,jqXHR:e,textStatus:t,errorThrown:n})}})}}),r("milkman/commit",["../milkman/Private/makeUrlServer","../milkman/Private/request","../milkman/Utils/constants"],function(e,t,n){"use strict";return function(r){var i=window.localStorage.getItem(n.SESSION_TOKEN),s=window.localStorage.getItem(n.REDIRECT_URI);console.log(" SESSION_TOKEN. "+n.SESSION_TOKEN),console.log(i+" . "+s),i&&s?t(s+"/commit","POST",{session_id:i},function(e){e.success?r({success:!0}):r({success:!1,text:e.jqXHR})}):r({success:!1,text:n.ERROR.BAD_REQUEST_400})}}),r("milkman/Utils/defaults",{SESSION_TOKEN:"123456",REDIRECT_URI:"http://localhost:3003",SET_A1:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",trackingCode:"prova123"},SET_A2:{publishableKey:"test-public-key",redirectUri:"",trackingCode:""},SET_A3:{publishableKey:"",redirectUri:"http://localhost:3003",trackingCode:""},SET_A4:{publishableKey:"",redirectUri:"",trackingCode:"prova123"},SET_A5:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",trackingCode:"prova123",cart:[{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{id:"ciaoaoaoaoaoao"}}]},SET_A6:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",trackingCode:"prova123",cart:[{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti",lat:40.372186,lng:-74.01118099999997}}]},SET_A7:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",trackingCode:"prova123",cart:[{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti"}}]},SET_A8:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",trackingCode:"prova123",cart:[{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{lat:40.372186,lng:-74.01118099999997}}]},SET_A9:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",trackingCode:"prova123",cart:[{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{type:"standard",length:1,height:1,depth:1,volume:300}}]},SET_A10:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",trackingCode:"prova123",cart:[{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{id:"ciaoaoaoaoaoao"}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti",lat:40.372186,lng:-74.01118099999997}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti"}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{lat:40.372186,lng:-74.01118099999997}}]},SET_A11:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",cart:[{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti",lat:40.372186,lng:-74.01118099999997}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{id:"ciaoaoaoaoaoao"}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{lat:40.372186,lng:-74.01118099999997}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti"}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{}},{firstAvailableDay:"2015-10-18T12:00",value:100,auxCost:5.5,weight:12.47,pickUp:{id:"",address:"",lat:null,lng:""}}]},SET_A12:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",cart:[{value:100}]},SET_A13:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",cart:[{firstAvailableDay:"2015-10-18"}]},SET_A14:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",cart:[{auxCost:5.5}]},SET_A15:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",cart:[{weight:5.5}]},SET_A16:{publishableKey:"test-public-key",redirectUri:"http://localhost:3003",cart:[{type:"standard",length:1,height:1,depth:1,volume:300}]},SET_B1:[{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti",lat:40.372186,lng:-74.01118099999997,heading:36.94424778789316,pitch:-6.11509517212225,deliverInstructions:"Beware the dog"}],SET_B2:[{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti"}],SET_B3:[{address:"blablablablablabla"}],SET_B4:[{lat:40.372186,lng:-74.01118099999997}],SET_B5:[{deliverInstructions:"Beware the dog"}],SET_B6:[{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti"},{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti",lat:40.372186,lng:-74.01118099999997,heading:36.94424778789316,pitch:-6.11509517212225,deliverInstructions:"Beware the dog"},{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti"}],SET_B7:[{address:"22 Oak Ln, Rumson, NJ 07760, Stati Uniti",lat:40.372186,lng:-74.01118099999997,heading:36.94424778789316,pitch:-6.11509517212225,deliverInstructions:"Beware the dog"},{address:"blablablablablabla"},{lat:40.372186,lng:-74.01118099999997}],SET_B8:[{lat:"",lng:"ciao ciao"}],SET_B9:[{address:""}],QUOTES:{intervals:[{interval:"2015-09-01T09:00:00Z/2015-09-01T09:30:00Z",price:"1,99",weight:"0,25",currency:"euro"},{interval:"2015-09-01T09:30:00Z/2015-09-01T10:00:00Z",price:"1,99",weight:"0,85",currency:"euro"},{interval:"2015-09-01T10:00:00Z/2015-09-01T10:30:00Z",price:"1,99",weight:"0,15",currency:"euro"},{interval:"2015-09-01T10:30:00Z/2015-09-01T11:00:00Z",price:"1,99",weight:"0,85",currency:"euro"},{interval:"2015-09-01T11:00:00Z/2015-09-01T11:30:00Z",price:"1,99",weight:"0,25",currency:"euro"}],discounts:[{range:"0/1",discount:"0",type:"percent"},{range:"1/2",discount:"2",type:"percent"},{range:"2/4",discount:"10",type:"percent"},{range:"4/8",discount:"20",type:"percent"},{range:"8/",discount:"100",type:"percent"}]},DEPOT_1:{name:"magazzino 1",location:"111111"},DEPOT_2:{name:"magazzino 2",location:"211111"},DEPOT_3:{name:"magazzino 3",location:"311111"}}),function(e,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof r=="function"&&r.amd?r("moment",t):e.moment=t()}(this,function(){"use strict";function t(){return e.apply(null,arguments)}function r(t){e=t}function i(e){return Object.prototype.toString.call(e)==="[object Array]"}function s(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function o(e,t){var n=[],r;for(r=0;r<e.length;++r)n.push(t(e[r],r));return n}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){for(var n in t)u(t,n)&&(e[n]=t[n]);return u(t,"toString")&&(e.toString=t.toString),u(t,"valueOf")&&(e.valueOf=t.valueOf),e}function f(e,t,n,r){return yn(e,t,n,r,!0).utc()}function l(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function c(e){return e._pf==null&&(e._pf=l()),e._pf}function h(e){if(e._isValid==null){var t=c(e);e._isValid=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated,e._strict&&(e._isValid=e._isValid&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined)}return e._isValid}function p(e){var t=f(NaN);return e!=null?a(c(t),e):c(t).userInvalidated=!0,t}function v(e,t){var n,r,i;typeof t._isAMomentObject!="undefined"&&(e._isAMomentObject=t._isAMomentObject),typeof t._i!="undefined"&&(e._i=t._i),typeof t._f!="undefined"&&(e._f=t._f),typeof t._l!="undefined"&&(e._l=t._l),typeof t._strict!="undefined"&&(e._strict=t._strict),typeof t._tzm!="undefined"&&(e._tzm=t._tzm),typeof t._isUTC!="undefined"&&(e._isUTC=t._isUTC),typeof t._offset!="undefined"&&(e._offset=t._offset),typeof t._pf!="undefined"&&(e._pf=c(t)),typeof t._locale!="undefined"&&(e._locale=t._locale);if(d.length>0)for(n in d)r=d[n],i=t[r],typeof i!="undefined"&&(e[r]=i);return e}function g(e){v(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),m===!1&&(m=!0,t.updateOffset(this),m=!1)}function y(e){return e instanceof g||e!=null&&e._isAMomentObject!=null}function b(e){return e<0?Math.ceil(e):Math.floor(e)}function w(e){var t=+e,n=0;return t!==0&&isFinite(t)&&(n=b(t)),n}function E(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0,o;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&w(e[o])!==w(t[o]))&&s++;return s+i}function S(){}function N(e){return e?e.toLowerCase().replace("_","-"):e}function C(e){var t=0,n,r,i,s;while(t<e.length){s=N(e[t]).split("-"),n=s.length,r=N(e[t+1]),r=r?r.split("-"):null;while(n>0){i=k(s.slice(0,n).join("-"));if(i)return i;if(r&&r.length>=n&&E(s,r,!0)>=n-1)break;n--}t++}return null}function k(e){var t=null;if(!x[e]&&typeof module!="undefined"&&module&&module.exports)try{t=T._abbr,n("./locale/"+e),L(t)}catch(r){}return x[e]}function L(e,t){var n;return e&&(typeof t=="undefined"?n=O(e):n=A(e,t),n&&(T=n)),T._abbr}function A(e,t){return t!==null?(t.abbr=e,x[e]=x[e]||new S,x[e].set(t),L(e),x[e]):(delete x[e],null)}function O(e){var t;e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr);if(!e)return T;if(!i(e)){t=k(e);if(t)return t;e=[e]}return C(e)}function _(e,t){var n=e.toLowerCase();M[n]=M[n+"s"]=M[t]=e}function D(e){return typeof e=="string"?M[e]||M[e.toLowerCase()]:undefined}function P(e){var t={},n,r;for(r in e)u(e,r)&&(n=D(r),n&&(t[n]=e[r]));return t}function H(e,n){return function(r){return r!=null?(j(this,e,r),t.updateOffset(this,n),this):B(this,e)}}function B(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function j(e,t,n){return e._d["set"+(e._isUTC?"UTC":"")+t](n)}function F(e,t){var n;if(typeof e=="object")for(n in e)this.set(n,e[n]);else{e=D(e);if(typeof this[e]=="function")return this[e](t)}return this}function I(e,t,n){var r=""+Math.abs(e),i=t-r.length,s=e>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}function W(e,t,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),e&&(z[e]=i),t&&(z[t[0]]=function(){return I(i.apply(this,arguments),t[1],t[2])}),n&&(z[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function X(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function V(e){var t=e.match(q),n,r;for(n=0,r=t.length;n<r;n++)z[t[n]]?t[n]=z[t[n]]:t[n]=X(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=t[n]instanceof Function?t[n].call(i,e):t[n];return s}}function $(e,t){return e.isValid()?(t=J(t,e.localeData()),U[t]=U[t]||V(t),U[t](e)):e.localeData().invalidDate()}function J(e,t){function r(e){return t.longDateFormat(e)||e}var n=5;R.lastIndex=0;while(n>=0&&R.test(e))e=e.replace(R,r),R.lastIndex=0,n-=1;return e}function lt(e){return typeof e=="function"&&Object.prototype.toString.call(e)==="[object Function]"}function ct(e,t,n){ft[e]=lt(t)?t:function(e){return e&&n?n:t}}function ht(e,t){return u(ft,e)?ft[e](t._strict,t._locale):new RegExp(pt(e))}function pt(e){return e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function vt(e,t){var n,r=t;typeof e=="string"&&(e=[e]),typeof t=="number"&&(r=function(e,n){n[t]=w(e)});for(n=0;n<e.length;n++)dt[e[n]]=r}function mt(e,t){vt(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function gt(e,t,n){t!=null&&u(dt,e)&&dt[e](t,n._a,n,e)}function Nt(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function kt(e){return this._months[e.month()]}function At(e){return this._monthsShort[e.month()]}function Ot(e,t,n){var r,i,s;this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(r=0;r<12;r++){i=f([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i"));if(n&&t==="MMMM"&&this._longMonthsParse[r].test(e))return r;if(n&&t==="MMM"&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function Mt(e,t){var n;if(typeof t=="string"){t=e.localeData().monthsParse(t);if(typeof t!="number")return e}return n=Math.min(e.date(),Nt(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function _t(e){return e!=null?(Mt(this,e),t.updateOffset(this,!0),this):B(this,"Month")}function Dt(){return Nt(this.year(),this.month())}function Pt(e){var t,n=e._a;return n&&c(e).overflow===-2&&(t=n[bt]<0||n[bt]>11?bt:n[wt]<1||n[wt]>Nt(n[yt],n[bt])?wt:n[Et]<0||n[Et]>24||n[Et]===24&&(n[St]!==0||n[xt]!==0||n[Tt]!==0)?Et:n[St]<0||n[St]>59?St:n[xt]<0||n[xt]>59?xt:n[Tt]<0||n[Tt]>999?Tt:-1,c(e)._overflowDayOfYear&&(t<yt||t>wt)&&(t=wt),c(e).overflow=t),e}function Ht(e){t.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+e)}function Bt(e,t){var n=!0;return a(function(){return n&&(Ht(e+"\n"+(new Error).stack),n=!1),t.apply(this,arguments)},t)}function Ft(e,t){jt[e]||(Ht(t),jt[e]=!0)}function zt(e){var t,n,r=e._i,i=It.exec(r);if(i){c(e).iso=!0;for(t=0,n=qt.length;t<n;t++)if(qt[t][1].exec(r)){e._f=qt[t][0];break}for(t=0,n=Rt.length;t<n;t++)if(Rt[t][1].exec(r)){e._f+=(i[6]||" ")+Rt[t][0];break}r.match(ot)&&(e._f+="Z"),cn(e)}else e._isValid=!1}function Wt(e){var n=Ut.exec(e._i);if(n!==null){e._d=new Date(+n[1]);return}zt(e),e._isValid===!1&&(delete e._isValid,t.createFromInputFallback(e))}function Xt(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return e<1970&&u.setFullYear(e),u}function Vt(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function $t(e){return Jt(e)?366:365}function Jt(e){return e%4===0&&e%100!==0||e%400===0}function Qt(){return Jt(this.year())}function Gt(e,t,n){var r=n-t,i=n-e.day(),s;return i>r&&(i-=7),i<r-7&&(i+=7),s=bn(e).add(i,"d"),{week:Math.ceil(s.dayOfYear()/7),year:s.year()}}function Yt(e){return Gt(e,this._week.dow,this._week.doy).week}function en(){return this._week.dow}function tn(){return this._week.doy}function nn(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function rn(e){var t=Gt(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}function sn(e,t,n,r,i){var s=6+i-r,o=Vt(e,0,1+s),u=o.getUTCDay(),a;return u<i&&(u+=7),n=n!=null?1*n:i,a=1+s+7*(t-1)-u+n,{year:a>0?e:e-1,dayOfYear:a>0?a:$t(e-1)+a}}function on(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}function un(e,t,n){return e!=null?e:t!=null?t:n}function an(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function fn(e){var t,n,r=[],i,s;if(e._d)return;i=an(e),e._w&&e._a[wt]==null&&e._a[bt]==null&&ln(e),e._dayOfYear&&(s=un(e._a[yt],i[yt]),e._dayOfYear>$t(s)&&(c(e)._overflowDayOfYear=!0),n=Vt(s,0,e._dayOfYear),e._a[bt]=n.getUTCMonth(),e._a[wt]=n.getUTCDate());for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=r[t]=i[t];for(;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Et]===24&&e._a[St]===0&&e._a[xt]===0&&e._a[Tt]===0&&(e._nextDay=!0,e._a[Et]=0),e._d=(e._useUTC?Vt:Xt).apply(null,r),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Et]=24)}function ln(e){var t,n,r,i,s,o,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(s=1,o=4,n=un(t.GG,e._a[yt],Gt(bn(),1,4).year),r=un(t.W,1),i=un(t.E,1)):(s=e._locale._week.dow,o=e._locale._week.doy,n=un(t.gg,e._a[yt],Gt(bn(),s,o).year),r=un(t.w,1),t.d!=null?(i=t.d,i<s&&++r):t.e!=null?i=t.e+s:i=s),u=sn(n,r,i,o,s),e._a[yt]=u.year,e._dayOfYear=u.dayOfYear}function cn(e){if(e._f===t.ISO_8601){zt(e);return}e._a=[],c(e).empty=!0;var n=""+e._i,r,i,s,o,u,a=n.length,f=0;s=J(e._f,e._locale).match(q)||[];for(r=0;r<s.length;r++)o=s[r],i=(n.match(ht(o,e))||[])[0],i&&(u=n.substr(0,n.indexOf(i)),u.length>0&&c(e).unusedInput.push(u),n=n.slice(n.indexOf(i)+i.length),f+=i.length),z[o]?(i?c(e).empty=!1:c(e).unusedTokens.push(o),gt(o,i,e)):e._strict&&!i&&c(e).unusedTokens.push(o);c(e).charsLeftOver=a-f,n.length>0&&c(e).unusedInput.push(n),c(e).bigHour===!0&&e._a[Et]<=12&&e._a[Et]>0&&(c(e).bigHour=undefined),e._a[Et]=hn(e._locale,e._a[Et],e._meridiem),fn(e),Pt(e)}function hn(e,t,n){var r;return n==null?t:e.meridiemHour!=null?e.meridiemHour(t,n):e.isPM!=null?(r=e.isPM(n),r&&t<12&&(t+=12),!r&&t===12&&(t=0),t):t}function pn(e){var t,n,r,i,s;if(e._f.length===0){c(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){s=0,t=v({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],cn(t);if(!h(t))continue;s+=c(t).charsLeftOver,s+=c(t).unusedTokens.length*10,c(t).score=s;if(r==null||s<r)r=s,n=t}a(e,n||t)}function dn(e){if(e._d)return;var t=P(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],fn(e)}function vn(e){var t=new g(Pt(mn(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function mn(e){var t=e._i,n=e._f;return e._locale=e._locale||O(e._l),t===null||n===undefined&&t===""?p({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),y(t)?new g(Pt(t)):(i(n)?pn(e):n?cn(e):s(t)?e._d=t:gn(e),e))}function gn(e){var n=e._i;n===undefined?e._d=new Date:s(n)?e._d=new Date(+n):typeof n=="string"?Wt(e):i(n)?(e._a=o(n.slice(0),function(e){return parseInt(e,10)}),fn(e)):typeof n=="object"?dn(e):typeof n=="number"?e._d=new Date(n):t.createFromInputFallback(e)}function yn(e,t,n,r,i){var s={};return typeof n=="boolean"&&(r=n,n=undefined),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=e,s._f=t,s._strict=r,vn(s)}function bn(e,t,n,r){return yn(e,t,n,r,!1)}function Sn(e,t){var n,r;t.length===1&&i(t[0])&&(t=t[0]);if(!t.length)return bn();n=t[0];for(r=1;r<t.length;++r)if(!t[r].isValid()||t[r][e](n))n=t[r];return n}function xn(){var e=[].slice.call(arguments,0);return Sn("isBefore",e)}function Tn(){var e=[].slice.call(arguments,0);return Sn("isAfter",e)}function Nn(e){var t=P(e),n=t.year||0,r=t.quarter||0,i=t.month||0,s=t.week||0,o=t.day||0,u=t.hour||0,a=t.minute||0,f=t.second||0,l=t.millisecond||0;this._milliseconds=+l+f*1e3+a*6e4+u*36e5,this._days=+o+s*7,this._months=+i+r*3+n*12,this._data={},this._locale=O(),this._bubble()}function Cn(e){return e instanceof Nn}function kn(e,t){W(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+I(~~(e/60),2)+t+I(~~e%60,2)})}function An(e){var t=(e||"").match(ot)||[],n=t[t.length-1]||[],r=(n+"").match(Ln)||["-",0,0],i=+(r[1]*60)+w(r[2]);return r[0]==="+"?i:-i}function On(e,n){var r,i;return n._isUTC?(r=n.clone(),i=(y(e)||s(e)?+e:+bn(e))- +r,r._d.setTime(+r._d+i),t.updateOffset(r,!1),r):bn(e).local()}function Mn(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}function _n(e,n){var r=this._offset||0,i;return e!=null?(typeof e=="string"&&(e=An(e)),Math.abs(e)<16&&(e*=60),!this._isUTC&&n&&(i=Mn(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==e&&(!n||this._changeInProgress?Qn(this,Xn(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:Mn(this)}function Dn(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Pn(e){return this.utcOffset(0,e)}function Hn(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Mn(this),"m")),this}function Bn(){return this._tzm?this.utcOffset(this._tzm):typeof this._i=="string"&&this.utcOffset(An(this._i)),this}function jn(e){return e=e?bn(e).utcOffset():0,(this.utcOffset()-e)%60===0}function Fn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function In(){if(typeof this._isDSTShifted!="undefined")return this._isDSTShifted;var e={};v(e,this),e=mn(e);if(e._a){var t=e._isUTC?f(e._a):bn(e._a);this._isDSTShifted=this.isValid()&&E(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function qn(){return!this._isUTC}function Rn(){return this._isUTC}function Un(){return this._isUTC&&this._offset===0}function Xn(e,t){var n=e,r=null,i,s,o;return Cn(e)?n={ms:e._milliseconds,d:e._days,M:e._months}:typeof e=="number"?(n={},t?n[t]=e:n.milliseconds=e):(r=zn.exec(e))?(i=r[1]==="-"?-1:1,n={y:0,d:w(r[wt])*i,h:w(r[Et])*i,m:w(r[St])*i,s:w(r[xt])*i,ms:w(r[Tt])*i}):(r=Wn.exec(e))?(i=r[1]==="-"?-1:1,n={y:Vn(r[2],i),M:Vn(r[3],i),d:Vn(r[4],i),h:Vn(r[5],i),m:Vn(r[6],i),s:Vn(r[7],i),w:Vn(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=Jn(bn(n.from),bn(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new Nn(n),Cn(e)&&u(e,"_locale")&&(s._locale=e._locale),s}function Vn(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function $n(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function Jn(e,t){var n;return t=On(t,e),e.isBefore(t)?n=$n(e,t):(n=$n(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function Kn(e,t){return function(n,r){var i,s;return r!==null&&!isNaN(+r)&&(Ft(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=n,n=r,r=s),n=typeof n=="string"?+n:n,i=Xn(n,r),Qn(this,i,e),this}}function Qn(e,n,r,i){var s=n._milliseconds,o=n._days,u=n._months;i=i==null?!0:i,s&&e._d.setTime(+e._d+s*r),o&&j(e,"Date",B(e,"Date")+o*r),u&&Mt(e,B(e,"Month")+u*r),i&&t.updateOffset(e,o||u)}function Zn(e,t){var n=e||bn(),r=On(n,this).startOf("day"),i=this.diff(r,"days",!0),s=i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse";return this.format(t&&t[s]||this.localeData().calendar(s,this,bn(n)))}function er(){return new g(this)}function tr(e,t){var n;return t=D(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(e=y(e)?e:bn(e),+this>+e):(n=y(e)?+e:+bn(e),n<+this.clone().startOf(t))}function nr(e,t){var n;return t=D(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(e=y(e)?e:bn(e),+this<+e):(n=y(e)?+e:+bn(e),+this.clone().endOf(t)<n)}function rr(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)}function ir(e,t){var n;return t=D(t||"millisecond"),t==="millisecond"?(e=y(e)?e:bn(e),+this===+e):(n=+bn(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))}function sr(e,t,n){var r=On(e,this),i=(r.utcOffset()-this.utcOffset())*6e4,s,o;return t=D(t),t==="year"||t==="month"||t==="quarter"?(o=or(this,r),t==="quarter"?o/=3:t==="year"&&(o/=12)):(s=this-r,o=t==="second"?s/1e3:t==="minute"?s/6e4:t==="hour"?s/36e5:t==="day"?(s-i)/864e5:t==="week"?(s-i)/6048e5:s),n?o:b(o)}function or(e,t){var n=(t.year()-e.year())*12+(t.month()-e.month()),r=e.clone().add(n,"months"),i,s;return t-r<0?(i=e.clone().add(n-1,"months"),s=(t-r)/(r-i)):(i=e.clone().add(n+1,"months"),s=(t-r)/(i-r)),-(n+s)}function ur(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ar(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():$(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):$(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function fr(e){var n=$(this,e||t.defaultFormat);return this.localeData().postformat(n)}function lr(e,t){return this.isValid()?Xn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function cr(e){return this.from(bn(),e)}function hr(e,t){return this.isValid()?Xn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function pr(e){return this.to(bn(),e)}function dr(e){var t;return e===undefined?this._locale._abbr:(t=O(e),t!=null&&(this._locale=t),this)}function mr(){return this._locale}function gr(e){e=D(e);switch(e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"&&this.weekday(0),e==="isoWeek"&&this.isoWeekday(1),e==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function yr(e){return e=D(e),e===undefined||e==="millisecond"?this:this.startOf(e).add(1,e==="isoWeek"?"week":e).subtract(1,"ms")}function br(){return+this._d-(this._offset||0)*6e4}function wr(){return Math.floor(+this/1e3)}function Er(){return this._offset?new Date(+this):this._d}function Sr(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function xr(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Tr(){return h(this)}function Nr(){return a({},c(this))}function Cr(){return c(this).overflow}function kr(e,t){W(0,[e,e.length],0,t)}function Lr(e,t,n){return Gt(bn([e,11,31+t-n]),t,n).week}function Ar(e){var t=Gt(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return e==null?t:this.add(e-t,"y")}function Or(e){var t=Gt(this,1,4).year;return e==null?t:this.add(e-t,"y")}function Mr(){return Lr(this.year(),1,4)}function _r(){var e=this.localeData()._week;return Lr(this.year(),e.dow,e.doy)}function Dr(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}function Hr(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function jr(e){return this._weekdays[e.day()]}function Ir(e){return this._weekdaysShort[e.day()]}function Rr(e){return this._weekdaysMin[e.day()]}function Ur(e){var t,n,r;this._weekdaysParse=this._weekdaysParse||[];for(t=0;t<7;t++){this._weekdaysParse[t]||(n=bn([2e3,1]).day(t),r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i"));if(this._weekdaysParse[t].test(e))return t}}function zr(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Hr(e,this.localeData()),this.add(e-t,"d")):t}function Wr(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Xr(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)}function Vr(e,t){W(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function $r(e,t){return t._meridiemParse}function Jr(e){return(e+"").toLowerCase().charAt(0)==="p"}function Qr(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function ti(e,t){t[Tt]=w(("0."+e)*1e3)}function ri(){return this._isUTC?"UTC":""}function ii(){return this._isUTC?"Coordinated Universal Time":""}function ui(e){return bn(e*1e3)}function ai(){return bn.apply(null,arguments).parseZone()}function li(e,t,n){var r=this._calendar[e];return typeof r=="function"?r.call(t,n):r}function hi(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function di(){return this._invalidDate}function gi(e){return this._ordinal.replace("%d",e)}function yi(e){return e}function wi(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)}function Ei(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)}function Si(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function Ti(e,t,n,r){var i=O(),s=f().set(r,t);return i[n](s,e)}function Ni(e,t,n,r,i){typeof e=="number"&&(t=e,e=undefined),e=e||"";if(t!=null)return Ti(e,t,n,i);var s,o=[];for(s=0;s<r;s++)o[s]=Ti(e,s,n,i);return o}function Ci(e,t){return Ni(e,t,"months",12,"month")}function ki(e,t){return Ni(e,t,"monthsShort",12,"month")}function Li(e,t){return Ni(e,t,"weekdays",7,"day")}function Ai(e,t){return Ni(e,t,"weekdaysShort",7,"day")}function Oi(e,t){return Ni(e,t,"weekdaysMin",7,"day")}function _i(){var e=this._data;return this._milliseconds=Mi(this._milliseconds),this._days=Mi(this._days),this._months=Mi(this._months),e.milliseconds=Mi(e.milliseconds),e.seconds=Mi(e.seconds),e.minutes=Mi(e.minutes),e.hours=Mi(e.hours),e.months=Mi(e.months),e.years=Mi(e.years),this}function Di(e,t,n,r){var i=Xn(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Pi(e,t){return Di(this,e,t,1)}function Hi(e,t){return Di(this,e,t,-1)}function Bi(e){return e<0?Math.floor(e):Math.ceil(e)}function ji(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u,a;return e>=0&&t>=0&&n>=0||e<=0&&t<=0&&n<=0||(e+=Bi(Ii(n)+t)*864e5,t=0,n=0),r.milliseconds=e%1e3,i=b(e/1e3),r.seconds=i%60,s=b(i/60),r.minutes=s%60,o=b(s/60),r.hours=o%24,t+=b(o/24),a=b(Fi(t)),n+=a,t-=Bi(Ii(a)),u=b(n/12),n%=12,r.days=t,r.months=n,r.years=u,this}function Fi(e){return e*4800/146097}function Ii(e){return e*146097/4800}function qi(e){var t,n,r=this._milliseconds;e=D(e);if(e==="month"||e==="year")return t=this._days+r/864e5,n=this._months+Fi(t),e==="month"?n:n/12;t=this._days+Math.round(Ii(this._months));switch(e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return t*24+r/36e5;case"minute":return t*1440+r/6e4;case"second":return t*86400+r/1e3;case"millisecond":return Math.floor(t*864e5)+r;default:throw new Error("Unknown unit "+e)}}function Ri(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+w(this._months/12)*31536e6}function Ui(e){return function(){return this.as(e)}}function Gi(e){return e=D(e),this[e+"s"]()}function Yi(e){return function(){return this._data[e]}}function os(){return b(this.days()/7)}function fs(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function ls(e,t,n){var r=Xn(e).abs(),i=us(r.as("s")),s=us(r.as("m")),o=us(r.as("h")),u=us(r.as("d")),a=us(r.as("M")),f=us(r.as("y")),l=i<as.s&&["s",i]||s===1&&["m"]||s<as.m&&["mm",s]||o===1&&["h"]||o<as.h&&["hh",o]||u===1&&["d"]||u<as.d&&["dd",u]||a===1&&["M"]||a<as.M&&["MM",a]||f===1&&["y"]||["yy",f];return l[2]=t,l[3]=+e>0,l[4]=n,fs.apply(null,l)}function cs(e,t){return as[e]===undefined?!1:t===undefined?as[e]:(as[e]=t,!0)}function hs(e){var t=this.localeData(),n=ls(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function ds(){var e=ps(this._milliseconds)/1e3,t=ps(this._days),n=ps(this._months),r,i,s;r=b(e/60),i=b(r/60),e%=60,r%=60,s=b(n/12),n%=12;var o=s,u=n,a=t,f=i,l=r,c=e,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(o?o+"Y":"")+(u?u+"M":"")+(a?a+"D":"")+(f||l||c?"T":"")+(f?f+"H":"")+(l?l+"M":"")+(c?c+"S":""):"P0D"}var e,d=t.momentProperties=[],m=!1,x={},T,M={},q=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,R=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,U={},z={},K=/\d/,Q=/\d\d/,G=/\d{3}/,Y=/\d{4}/,Z=/[+-]?\d{6}/,et=/\d\d?/,tt=/\d{1,3}/,nt=/\d{1,4}/,rt=/[+-]?\d{1,6}/,it=/\d+/,st=/[+-]?\d+/,ot=/Z|[+-]\d\d:?\d\d/gi,ut=/[+-]?\d+(\.\d{1,3})?/,at=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ft={},dt={},yt=0,bt=1,wt=2,Et=3,St=4,xt=5,Tt=6;W("M",["MM",2],"Mo",function(){return this.month()+1}),W("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),W("MMMM",0,0,function(e){return this.localeData().months(this,e)}),_("month","M"),ct("M",et),ct("MM",et,Q),ct("MMM",at),ct("MMMM",at),vt(["M","MM"],function(e,t){t[bt]=w(e)-1}),vt(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);i!=null?t[bt]=i:c(n).invalidMonth=e});var Ct="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Lt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),jt={};t.suppressDeprecationWarnings=!1;var It=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,qt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Rt=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ut=/^\/?Date\((\-?\d+)/i;t.createFromInputFallback=Bt("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),W(0,["YY",2],0,function(){return this.year()%100}),W(0,["YYYY",4],0,"year"),W(0,["YYYYY",5],0,"year"),W(0,["YYYYYY",6,!0],0,"year"),_("year","y"),ct("Y",st),ct("YY",et,Q),ct("YYYY",nt,Y),ct("YYYYY",rt,Z),ct("YYYYYY",rt,Z),vt(["YYYYY","YYYYYY"],yt),vt("YYYY",function(e,n){n[yt]=e.length===2?t.parseTwoDigitYear(e):w(e)}),vt("YY",function(e,n){n[yt]=t.parseTwoDigitYear(e)}),t.parseTwoDigitYear=function(e){return w(e)+(w(e)>68?1900:2e3)};var Kt=H("FullYear",!1);W("w",["ww",2],"wo","week"),W("W",["WW",2],"Wo","isoWeek"),_("week","w"),_("isoWeek","W"),ct("w",et),ct("ww",et,Q),ct("W",et),ct("WW",et,Q),mt(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=w(e)});var Zt={dow:0,doy:6};W("DDD",["DDDD",3],"DDDo","dayOfYear"),_("dayOfYear","DDD"),ct("DDD",tt),ct("DDDD",G),vt(["DDD","DDDD"],function(e,t,n){n._dayOfYear=w(e)}),t.ISO_8601=function(){};var wn=Bt("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=bn.apply(null,arguments);return e<this?this:e}),En=Bt("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=bn.apply(null,arguments);return e>this?this:e});kn("Z",":"),kn("ZZ",""),ct("Z",ot),ct("ZZ",ot),vt(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=An(e)});var Ln=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var zn=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Wn=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Xn.fn=Nn.prototype;var Gn=Kn(1,"add"),Yn=Kn(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var vr=Bt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===undefined?this.localeData():this.locale(e)});W(0,["gg",2],0,function(){return this.weekYear()%100}),W(0,["GG",2],0,function(){return this.isoWeekYear()%100}),kr("gggg","weekYear"),kr("ggggg","weekYear"),kr("GGGG","isoWeekYear"),kr("GGGGG","isoWeekYear"),_("weekYear","gg"),_("isoWeekYear","GG"),ct("G",st),ct("g",st),ct("GG",et,Q),ct("gg",et,Q),ct("GGGG",nt,Y),ct("gggg",nt,Y),ct("GGGGG",rt,Z),ct("ggggg",rt,Z),mt(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=w(e)}),mt(["gg","GG"],function(e,n,r,i){n[i]=t.parseTwoDigitYear(e)}),W("Q",0,0,"quarter"),_("quarter","Q"),ct("Q",K),vt("Q",function(e,t){t[bt]=(w(e)-1)*3}),W("D",["DD",2],"Do","date"),_("date","D"),ct("D",et),ct("DD",et,Q),ct("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),vt(["D","DD"],wt),vt("Do",function(e,t){t[wt]=w(e.match(et)[0],10)});var Pr=H("Date",!0);W("d",0,"do","day"),W("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),W("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),W("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),W("e",0,0,"weekday"),W("E",0,0,"isoWeekday"),_("day","d"),_("weekday","e"),_("isoWeekday","E"),ct("d",et),ct("e",et),ct("E",et),ct("dd",at),ct("ddd",at),ct("dddd",at),mt(["dd","ddd","dddd"],function(e,t,n){var r=n._locale.weekdaysParse(e);r!=null?t.d=r:c(n).invalidWeekday=e}),mt(["d","e","E"],function(e,t,n,r){t[r]=w(e)});var Br="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Fr="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),qr="Su_Mo_Tu_We_Th_Fr_Sa".split("_");W("H",["HH",2],0,"hour"),W("h",["hh",2],0,function(){return this.hours()%12||12}),Vr("a",!0),Vr("A",!1),_("hour","h"),ct("a",$r),ct("A",$r),ct("H",et),ct("h",et),ct("HH",et,Q),ct("hh",et,Q),vt(["H","HH"],Et),vt(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),vt(["h","hh"],function(e,t,n){t[Et]=w(e),c(n).bigHour=!0});var Kr=/[ap]\.?m?\.?/i,Gr=H("Hours",!0);W("m",["mm",2],0,"minute"),_("minute","m"),ct("m",et),ct("mm",et,Q),vt(["m","mm"],St);var Yr=H("Minutes",!1);W("s",["ss",2],0,"second"),_("second","s"),ct("s",et),ct("ss",et,Q),vt(["s","ss"],xt);var Zr=H("Seconds",!1);W("S",0,0,function(){return~~(this.millisecond()/100)}),W(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),W(0,["SSS",3],0,"millisecond"),W(0,["SSSS",4],0,function(){return this.millisecond()*10}),W(0,["SSSSS",5],0,function(){return this.millisecond()*100}),W(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),W(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),W(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),W(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),_("millisecond","ms"),ct("S",tt,K),ct("SS",tt,Q),ct("SSS",tt,G);var ei;for(ei="SSSS";ei.length<=9;ei+="S")ct(ei,it);for(ei="S";ei.length<=9;ei+="S")vt(ei,ti);var ni=H("Milliseconds",!1);W("z",0,0,"zoneAbbr"),W("zz",0,0,"zoneName");var si=g.prototype;si.add=Gn,si.calendar=Zn,si.clone=er,si.diff=sr,si.endOf=yr,si.format=fr,si.from=lr,si.fromNow=cr,si.to=hr,si.toNow=pr,si.get=F,si.invalidAt=Cr,si.isAfter=tr,si.isBefore=nr,si.isBetween=rr,si.isSame=ir,si.isValid=Tr,si.lang=vr,si.locale=dr,si.localeData=mr,si.max=En,si.min=wn,si.parsingFlags=Nr,si.set=F,si.startOf=gr,si.subtract=Yn,si.toArray=Sr,si.toObject=xr,si.toDate=Er,si.toISOString=ar,si.toJSON=ar,si.toString=ur,si.unix=wr,si.valueOf=br,si.year=Kt,si.isLeapYear=Qt,si.weekYear=Ar,si.isoWeekYear=Or,si.quarter=si.quarters=Dr,si.month=_t,si.daysInMonth=Dt,si.week=si.weeks=nn,si.isoWeek=si.isoWeeks=rn,si.weeksInYear=_r,si.isoWeeksInYear=Mr,si.date=Pr,si.day=si.days=zr,si.weekday=Wr,si.isoWeekday=Xr,si.dayOfYear=on,si.hour=si.hours=Gr,si.minute=si.minutes=Yr,si.second=si.seconds=Zr,si.millisecond=si.milliseconds=ni,si.utcOffset=_n,si.utc=Pn,si.local=Hn,si.parseZone=Bn,si.hasAlignedHourOffset=jn,si.isDST=Fn,si.isDSTShifted=In,si.isLocal=qn,si.isUtcOffset=Rn,si.isUtc=Un,si.isUTC=Un,si.zoneAbbr=ri,si.zoneName=ii,si.dates=Bt("dates accessor is deprecated. Use date instead.",Pr),si.months=Bt("months accessor is deprecated. Use month instead",_t),si.years=Bt("years accessor is deprecated. Use year instead",Kt),si.zone=Bt("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Dn);var oi=si,fi={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},ci={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},pi="Invalid date",vi="%d",mi=/\d{1,2}/,bi={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},xi=S.prototype;xi._calendar=fi,xi.calendar=li,xi._longDateFormat=ci,xi.longDateFormat=hi,xi._invalidDate=pi,xi.invalidDate=di,xi._ordinal=vi,xi.ordinal=gi,xi._ordinalParse=mi,xi.preparse=yi,xi.postformat=yi,xi._relativeTime=bi,xi.relativeTime=wi,xi.pastFuture=Ei,xi.set=Si,xi.months=kt,xi._months=Ct,xi.monthsShort=At,xi._monthsShort=Lt,xi.monthsParse=Ot,xi.week=Yt,xi._week=Zt,xi.firstDayOfYear=tn,xi.firstDayOfWeek=en,xi.weekdays=jr,xi._weekdays=Br,xi.weekdaysMin=Rr,xi._weekdaysMin=qr,xi.weekdaysShort=Ir,xi._weekdaysShort=Fr,xi.weekdaysParse=Ur,xi.isPM=Jr,xi._meridiemParse=Kr,xi.meridiem=Qr,L("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=w(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),t.lang=Bt("moment.lang is deprecated. Use moment.locale instead.",L),t.langData=Bt("moment.langData is deprecated. Use moment.localeData instead.",O);var Mi=Math.abs,zi=Ui("ms"),Wi=Ui("s"),Xi=Ui("m"),Vi=Ui("h"),$i=Ui("d"),Ji=Ui("w"),Ki=Ui("M"),Qi=Ui("y"),Zi=Yi("milliseconds"),es=Yi("seconds"),ts=Yi("minutes"),ns=Yi("hours"),rs=Yi("days"),is=Yi("months"),ss=Yi("years"),us=Math.round,as={s:45,m:45,h:22,d:26,M:11},ps=Math.abs,vs=Nn.prototype;vs.abs=_i,vs.add=Pi,vs.subtract=Hi,vs.as=qi,vs.asMilliseconds=zi,vs.asSeconds=Wi,vs.asMinutes=Xi,vs.asHours=Vi,vs.asDays=$i,vs.asWeeks=Ji,vs.asMonths=Ki,vs.asYears=Qi,vs.valueOf=Ri,vs._bubble=ji,vs.get=Gi,vs.milliseconds=Zi,vs.seconds=es,vs.minutes=ts,vs.hours=ns,vs.days=rs,vs.weeks=os,vs.months=is,vs.years=ss,vs.humanize=hs,vs.toISOString=ds,vs.toString=ds,vs.toJSON=ds,vs.locale=dr,vs.localeData=mr,vs.toIsoString=Bt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ds),vs.lang=vr,W("X",0,0,"unix"),W("x",0,0,"valueOf"),ct("x",st),ct("X",ut),vt("X",function(e,t,n){n._d=new Date(parseFloat(e,10)*1e3)}),vt("x",function(e,t,n){n._d=new Date(w(e))}),t.version="2.10.6",r(bn),t.fn=oi,t.min=xn,t.max=Tn,t.utc=f,t.unix=ui,t.months=Ci,t.isDate=s,t.locale=L,t.invalid=p,t.duration=Xn,t.isMoment=y,t.weekdays=Li,t.parseZone=ai,t.localeData=O,t.isDuration=Cn,t.monthsShort=ki,t.weekdaysMin=Oi,t.defineLocale=A,t.weekdaysShort=Ai,t.normalizeUnits=D,t.relativeTimeThreshold=cs;var ms=t;return ms}),r("milkman/Private/checkInterval",["moment"],function(e){"use strict";return function(n,r,i){var s=r.filter(function(t){var r=t.interval.split("/")[0],i=t.interval.split("/")[1],s=n.filter(function(t){var n=t.split("/")[0],s=t.split("/")[1];if(e(r).diff(e(n))>=0&&e(s).diff(e(i))>=0)return!0});if(s.length)return!0});i(s)}}),r("milkman/Private/checkDayAvailability",["moment","../../milkman/Utils/constants"],function(e,t){"use strict";return function(r){var i=JSON.parse(window.localStorage.getItem(t.MERCHANT)),s=[i.availMon,i.availTue,i.availWed,i.availThu,i.availFri,i.availSat,i.availSun],o=e(r).format("E");return weekdays[o-1]}}),r("milkman/Private/checkMissingDates",["moment","../../milkman/Utils/constants","../../milkman/Private/checkDayAvailability"],function(e,t,n){"use strict";return function(i,s){if(t.intervals.length){var o=[];i.forEach(function(r){var i=r.split("T")[0],s=e(r.split("/")[1].split("T")[0]).diff(e(i),"days");for(var u=0;u<=s;u++){var a=!1,f=null;f=e(i).add(u,"days"),t.intervals.forEach(function(r,i){var s=e(r.interval.split("T")[0]),u=s.diff(f);u===0&&(a=!0),!a&&i+1===t.intervals.length&&n(f)&&o.push(f.format("YYYY-MM-DD")+"/"+f.format("YYYY-MM-DD"))})}}),s(o)}else s(i)}}),r("milkman/Private/recoverData",["../../milkman/Private/makeUrlServer","../../milkman/Private/request","../../milkman/Utils/constants"],function(e,t,n){"use strict";return function(i){var s=e("/recoverData"),o=window.localStorage.getItem(n.PUBLISHABLE_KEY),u=window.localStorage.getItem(n.SESSION_TOKEN);o&&u?t(s,"GET",{sessionId:u,publishableKey:o},function(e){e.success?(n.quotes=e.data.quote,i({success:!0,text:n.SUCCESS.OK_200,quotes:e.data.quote})):i({success:!1,text:e.jqXHR})}):i({success:!1,text:n.ERROR.UNAUTHORIZED_401})}}),r("milkman/Private/priceEngine",["./makeUrlServer","./request","./recoverData","../../milkman/Utils/constants"],function(e,t,n,r){"use strict";return function(t,n){function o(e){var n,i=r.discounts.filter(function(e){var n=e.range.split("/")[0]<=t.length,r=e.range.split("/")[1]===""?!0:t.length<e.range.split("/")[1];if(n&&r)return e});return i.length?n=Number(i[0].discount)*Number(e.price*e.weight):n=Number(e.price*e.weight),n}var i,s;t.forEach(function(e,r){if(r===0||i.weight>e.weight)i=e;r+1===t.length&&(s=o(i),n(s))})}}),r("milkman/Private/checkProposal",["moment","../../milkman/Utils/constants","../../milkman/Utils/defaults"],function(e,t,n){"use strict";return function(n,r,i){var s=t.proposals.filter(function(e){if(e.price===r){console.log("checkProposal: entered "+e.range);var t=e.range.filter(function(e){console.log("checkProposal: entered ");var t=n.filter(function(t){console.log("checkProposal: entered ");if(e===t)return!0});if(t.length!=0)return!0});if(t.length===n.length)return!0}});s.length!=0?i({success:!0}):i({success:!1})}}),r("milkman/Private/rangeNormalization",["moment","../../milkman/Utils/constants"],function(e,t){"use strict";return function(r,i){function v(e,t,n){var r=[];return e.forEach(function(e){var i=e.split("/")[0]?e.split("/")[0].split("T")[1]:null,s=e.split("/")[1]?e.split("/")[1].split("T")[1]:null,o=i!==undefined&&i!==null,u=s!==undefined&&s!==null;if(o&&u){var a=g(i,s,t),f=m(e,a,n*t);f.success&&r.push(f.range)}else r.push(e)}),r}function m(t,n,r){var i=t.split("/")[0].split("T")[0]+"T"+n.left,s=t.split("/")[1].split("T")[0]+"T"+n.right,o=e(s).diff(e(i),"minutes"),u=r<=o,a=i+"/"+s;return{success:u,range:a}}function g(e,t,n){var r,i,s=e.split(":")[1],o=t.split(":")[1];return s.charAt(1)!=0&&s.charAt(0)==5?(r=String(Number(e.split(":")[0])+1),r=r.length===1?"0"+r+":00":r+":00"):s.charAt(1)!=0?(s=n*Math.round(s/n)+n,r=e.split(":")[0]+":"+s):r=e,o.charAt(0)==0?i=t.split(":")[0]+":00":o.charAt(1)!=0?(o=n*Math.round(o/n)-n,i=t.split(":")[0]+":"+o):i=t,{left:r,right:i}}function y(t,n){var r=n.filter(function(n){if(e(n).diff(t)===0)return!0});return r.length>0}function b(e,t){var n=[!1,!1,!1,!1,!1,!1,!1];return e?e.forEach(function(e){t[e-1]&&(n[e-1]=!0)}):n=t,n}function w(e,t,n,r,i){var s=[];return t!==null?t.forEach(function(t){s.push(e+"T"+t.split("/")[0]+"/"+e+"T"+t.split("/")[1])}):n[0].split("T")[1]?s.push(e+"T"+n[0].split("T")[1]+"/"+e+"T"+n[1].split("T")[1]):s.push(e+"T"+r+"/"+e+"T"+i),s}var s=JSON.parse(window.localStorage.getItem(t.HUB)),o=JSON.parse(window.localStorage.getItem(t.MERCHANT)),u=s.bhInterval.split("/"),a=s.holidays,f=s.localHolidays,l=[s.availMon,s.availTue,s.availWed,s.availThu,s.availFri,s.availSat,s.availSun],c,h,p=[],d;d=b(r.weekdays,l),h=Array.isArray(r.ranges)?r.ranges:[r.ranges],c=v(h,o.atomicIntervalDimension,o.minDuration),c.length?(c.forEach(function(n){n=n.split("/");var s=n[1]===undefined?0:e(n[0]).isValid()&&e(n[1]).diff(e(n[0]),"days"),o=e(n[0]).isValid()&&e(n[1]).isValid();if(o){var l;for(var c=0;c<=s;c++){var h=e(n[0]).add(c,"days");if(d[e(h).format("E")-1]){var v=y(h.format("YYYY-MM-DD"),a),m=y(h.format("YYYY-MM-DD"),f);!v&&!m&&(l=w(h.format("YYYY-MM-DD"),r.hours?r.hours:null,n,u[0],u[1]),l&&l.forEach(function(e){p.push(e)}))}}}else i({success:!1,text:t.STATUS.FAILURE.RANGE_NOT_CORRECT})}),i({success:!0,ranges:p})):i({success:!1,text:t.STATUS.FAILURE.RANGE_NOT_VALID})}}),r("milkman/Entities/createEntity",["../Private/makeUrlServer","../Private/request"],function(e,t){"use strict";return function(r,i,s){var o=e("/"+r);t(o,"POST",i,function(e){e.success?s({success:!0,data:e.data}):s({success:!1,text:e.jqXHR})})}}),r("milkman/Entities/deleteEntity",["../Private/makeUrlServer","../Private/request"],function(e,t){"use strict";return function(r,i,s){var o=e("/"+r+"/"+i);t(o,"DELETE",null,function(e){e.success?s({success:!0}):s({success:!1,text:e.jqXHR})})}}),r("milkman/Entities/setEntity",["../Private/makeUrlServer","../Private/request"],function(e,t){"use strict";return function(r,i,s,o){var u=e("/"+r+"/"+i);t(u,"PUT",s,function(e){e.success?o({success:!0,data:e.data}):o({success:!1,text:e.jqXHR})})}}),r("milkman/Entities/getEntities",["../Private/makeUrlServer","../Private/request"],function(e,t){"use strict";return function(r,i,s){var o=i?e("/"+r+"/"+i):e("/"+r);t(o,"GET",null,function(e){e.success?s({success:!0,data:e.data}):s({success:!1,text:e.jqXHR})})}}),r("milkman/Private/checkCart",["moment"],function(e){"use strict";return function(n,r){function s(e){return!isNaN(parseFloat(e))&&isFinite(e)}var i=n.filter(function(t){var n=e(t.firstAvailableDay).isValid()&&t.firstAvailableDay;if(s(t.value)&&s(t.auxCost)&&s(t.weight)&&n&&(t.pickUp.id||t.pickUp.address||t.pickUp.lat&&t.pickUp.lng))return!0});r(i)}}),r("milkman/Public/setInit",["../../milkman/Private/makeUrlServer","../../milkman/Private/request","../../milkman/Utils/constants","moment","../../milkman/Private/checkCart"],function(e,t,n,r,i){"use strict";return function(o,u){var a=e("/authenticate");o.publishableKey&&o.redirectUri&&o.trackingCode&&o.cart?(window.localStorage.setItem(n.PUBLISHABLE_KEY,o.publishableKey),window.localStorage.setItem(n.REDIRECT_URI,o.redirectUri),i(o.cart,function(e){e.length===o.cart.length?t(a,"POST",{publishableKey:o.publishableKey,trackingCode:o.trackingCode,parcels:o.carts},function(e){if(e.success){window.localStorage.setItem(n.SESSION_TOKEN,e.data.session._id),window.localStorage.setItem(n.PROPOSAL_ID,e.data.session.proposalId),window.localStorage.setItem(n.MERCHANT,JSON.stringify(e.data.merchant)),window.localStorage.setItem(n.HUB,JSON.stringify(e.data.hub));var t=e.data.hub.firstAvailableDay,i=r(e.data.hub.firstAvailableDay).add(e.data.merchant.defaultRangeDays,"d").format("YYYY-MM-DD"),s=e.data.hub.bhInterval.split("/")[1];window.localStorage.setItem(n.DEFAULT_RANGE,t+"/"+i+"T"+s),u({status:"success",text:n.STATUS.SUCCESS.OK_200})}else u({status:"failure",text:e.jqXHR})}):u({status:"failure",text:n.STATUS.FAILURE.UNAUTHORIZED_401,error_message:n.ERROR_MESSAGE.MISSING_IN_PARCEL})})):u({status:"failure",text:n.STATUS.FAILURE.UNAUTHORIZED_401,error_message:n.ERROR_MESSAGE.MISSING})}}),r("milkman/Private/checkAddress",[],function(){"use strict";return function(t,n){function o(e,t){e.address?(new google.maps.Geocoder).geocode({address:e.address},function(n,r){r==google.maps.GeocoderStatus.OK?(e.lat=n[0].geometry.location.lat(),e.lng=n[0].geometry.location.lng(),e.evaluatedLatLng=!0):r==google.maps.GeocoderStatus.ZERO_RESULTS&&(s=!0),t(e)},function(e){}):t(null)}function u(e){return!isNaN(parseFloat(e))&&isFinite(e)}var r=[],i=[],s=!1;t?t.forEach(function(e,a){u(e.lat)&&u(e.lng)?r.push(e):i.push(e),a+1===t.length&&(i.length?i.forEach(function(e,t){o(e,function(e){e&&r.push(e),i.length===t+1&&n(r,s)})}):n(r,s))}):n(null)}}),r("milkman/Private/checkRequiredFields",["../../milkman/Utils/constants"],function(e){"use strict";return function(n){var r=window.localStorage.getItem(e.PUBLISHABLE_KEY),i=window.localStorage.getItem(e.REDIRECT_URI),s=window.localStorage.getItem(e.PROPOSAL_ID),o=window.localStorage.getItem(e.ADDRESSES);switch(n){case"init":return r&&i&&s;case"all":return r&&i&&s&&o}}}),r("milkman/Public/setAddress",["../../milkman/Private/makeUrlServer","../../milkman/Private/request","../../milkman/Utils/constants","../../milkman/Private/checkAddress","../../milkman/Private/checkRequiredFields"],function(e,t,n,r,i){"use strict";return function(o,u){var a=e("/sessionDetails"),f=i("init");f?r(o,function(e,r){e.length?t(a,"PUT",{sessionId:window.localStorage.getItem(n.SESSION_TOKEN),publishableKey:window.localStorage.getItem(n.PUBLISHABLE_KEY),proposalId:window.localStorage.getItem(n.PROPOSAL_ID),address:e},function(t){t.success?(window.localStorage.setItem(n.ADDRESSES,JSON.stringify(e)),r?u({status:"warning",text:n.STATUS.WARNING.ADDRESS_ZERO_RESULTS}):e.length===o.length?u({status:"success",text:n.SUCCESS.OK_200}):u({status:"warning",text:n.STATUS.WARNING.ADDRESS_INCORRECT})):u({status:"failure",text:t.jqXHR})}):u({status:"failure",text:n.STATUS.FAILURE.BAD_REQUEST_400,errorMessage:n.ERROR_MESSAGE.MISSING})}):u({status:"failure",text:n.STATUS.FAILURE.BAD_REQUEST_400,errorMessage:n.ERROR_MESSAGE.NO_PUBKEY_URI})}}),r("milkman/Private/quotation",["../../milkman/Private/makeUrlServer","../../milkman/Utils/constants","../../milkman/Private/request","../../milkman/Private/checkInterval"],function(e,t,n,r){"use strict";return function(s,o,u){var a=e("/quotation");o.length?n(a,"POST",{intervals:o,sessionId:window.localStorage.getItem(t.SESSION_TOKEN),publishableKey:window.localStorage.getItem(t.PUBLISHABLE_KEY)},function(e){t.discounts=e.data.session.discounts,e.data.session.intervals.forEach(function(e){t.intervals.push(e)}),r(s,t.intervals,function(e){u(e)})}):r(s,t.intervals,function(e){u(e)})}}),r("milkman/Private/getAllProposals",["moment"],function(e){"use strict";function t(e,t){var n=null;return e.forEach(function(e){var r=e.range.split("/")[0]<=t,i=e.range.split("/")[1]===""?!0:t<e.range.split("/")[1];r&&i&&(n=e.discount)}),n===null?1:n}return function(r,i,s){var o=[];return r.idi.forEach(function(n,u){var a=[],f=n.interval.split("T")[0],l=n.interval.split("/")[0].split("T")[1];for(var c=0;c<i;c++)if(u+c+1<=r.idi.length&&s<=c){var h=r.idi[u+c].interval.split("T")[0],p=r.idi[u+c].price*r.idi[u+c].weight,d=r.idi[u+c].interval.split("T")[2];if(e(h).diff(e(f))===0){var v=t(r.disc,c);a.push({day:f,i_bound:l,f_bound:d,range:l+"/"+d,f_price:p*v})}}a.forEach(function(e){o.push(e)})}),o.sort(function(e,t){return parseFloat(e.f_price)-parseFloat(t.f_price)}),o}}),r("milkman/Private/setPrice",["../../milkman/Private/priceEngine","../../milkman/Utils/constants"],function(e,t){"use strict";return function(r,i,s){i.length?e(i,function(e){s({status:"success",text:t.STATUS.SUCCESS.OK_200,ranges:r,price:e})}):s({status:"failure",text:t.STATUS.ERROR.NO_RESULTS_402})}}),r("milkman/Private/choosedProposals",["moment"],function(e){"use strict";return function(n,r,i,s,o){var u=0,a=[],f=o;return n.filter(function(t){if(u!==r){var n=!0,o=!0,f=null;a.forEach(function(r,o){var u=e(r.day).diff(e(t.day))===0;u&&(i>a[o].number?f=o:n=!1,s||r.ranges.forEach(function(r){var i=e(t.day+"T"+t.i_bound),s=e(t.day+"T"+t.f_bound),o=e(t.day+"T"+r.split("/")[0]),u=e(t.day+"T"+r.split("/")[1]),a=o.diff(i)>0&&o.diff(s)>=0,f=i.diff(u)>=0&&s.diff(u)>0;!a&&!f&&(n=!1)}))});if(n&&o)return u+=1,f!=null?(a[f].number=a[f].number+1,a[f].ranges.push(t.range)):a.push({day:t.day,number:1,ranges:[t.range]}),!0}})}}),r("milkman/Private/quoteEngine",["moment","../../milkman/Private/makeUrlServer","../../milkman/Utils/constants","../../milkman/Private/checkMissingDates","../../milkman/Private/quotation","../../milkman/Private/getAllProposals","../../milkman/Private/setPrice","../../milkman/Private/choosedProposals"],function(e,t,n,r,i,s,o,u){"use strict";return function(t,a,f){console.log("quoteEngine: "+JSON.stringify(a.ranges)),r(a.ranges,function(e){i(a.ranges,e,function(e){if(t==="findQuote"){var r=s({idi:e,disc:n.discounts},a.maxDuration,a.minDuration),i=[],l=u(r,a.quoteNumber,a.quotePerDate,a.overlap,a.distribution);l.forEach(function(e){i.push({range:e.day+"T"+e.range.split("/")[0]+"/"+e.day+"T"+e.range.split("/")[1],price:e.f_price})}),f({status:"success",text:n.STATUS.SUCCESS.OK_200,quotes:i})}else o(a.ranges,e,f)})})}}),r("milkman/Private/quoteHistory",["../../milkman/Private/makeUrlServer","../../milkman/Private/request","../../milkman/Utils/constants"],function(e,t,n){"use strict";return function(i,s){var o=e("/quoteHistory");t(o,"POST",{sessionId:window.localStorage.getItem(n.SESSION_TOKEN),publishableKey:window.localStorage.getItem(n.PUBLISHABLE_KEY),actionType:i,options:s},function(e){e.success})}}),r("milkman/Public/getQuote",["moment","../../milkman/Utils/constants","../../milkman/Private/rangeNormalization","../../milkman/Private/quoteEngine","../../milkman/Private/quoteHistory","../../milkman/Private/checkRequiredFields"],function(e,t,n,r,i,s){"use strict";return function(o,u){var a={},f=s("all");f?(i("getQuote",o),a.ranges=o.range?o.range:[window.localStorage.getItem(t.DEFAULT_RANGE)],a.weekdays=o.weekdays?o.weekdays:null,a.hours=o.hours?o.hours:null,a.morning=o.morning?o.morning:!0,a.afternoon=o.afternoon?o.afternoon:!0,Object.keys(o).length?n(a,function(e){e.success?(a.ranges=e.ranges,r("getQuote",a,u)):u({status:"failure",text:e.text})}):r("getQuote",a,u)):u({status:"failure",text:t.ERROR.BAD_REQUEST_400,errorMessage:t.ERROR_MESSAGE.NEED_REQUIRED})}}),r("milkman/Public/findQuote",["moment","../../milkman/Utils/constants","../../milkman/Private/rangeNormalization","../../milkman/Private/quoteEngine","../../milkman/Private/quoteHistory","../../milkman/Private/checkRequiredFields"],function(e,t,n,r,i,s){"use strict";return function(o,u){var a={},f=s("init"),l=JSON.parse(window.localStorage.getItem(t.MERCHANT));f?(i("findQuote",o),a.ranges=o.range?o.range:[window.localStorage.getItem(t.DEFAULT_RANGE)],a.quoteNumber=o.quoteNumber?o.quoteNumber:l.quoteNumber,a.maxDuration=o.maxDuration?o.maxDuration:l.maxDuration,a.quotePerDate=o.quotePerDate?o.quotePerDate:l.quotePerDate,a.overlap=o.overlap?o.overlap:l.overlap,a.minDuration=o.minDuration?o.minDuration:1,a.weekdays=o.weekdays?o.weekdays:null,a.hours=o.hours?o.hours:null,a.morning=o.morning?o.morning:null,a.afternoon=o.afternoon?o.afternoon:null,a.distribution=o.distribution?o.distribution:null,Object.keys(o).length?n(a,function(e){e.success?(a.ranges=e.ranges,r("findQuote",a,u)):u({status:"failure",text:e.text})}):r("findQuote",a,u)):u({status:"failure",text:t.ERROR.BAD_REQUEST_400,errorMessage:t.ERROR_MESSAGE.NEED_REQUIRED})}}),r("milkman/Public/confirm",["../../milkman/Private/makeUrlServer","../../milkman/Private/request","../../milkman/Utils/constants","../../milkman/commit","../../milkman/Public/getQuote","../../milkman/Private/quoteHistory","../../milkman/Private/checkRequiredFields"],function(e,t,n,r,i,s,o){"use strict";return function(a,f){var l=o("init");l?(s("confirm",a),i(a,function(i){if(i.success){var s=e("/priceConfirm"),o=window.localStorage.getItem(n.PUBLISHABLE_KEY),u=window.localStorage.getItem(n.SESSION_TOKEN);t(s,"POST",{sessionId:u,publishableKey:o,price:i.price,intervals:i.ranges},function(e){e.success?r(function(e){e.success?(window.localStorage.removeItem(n.SESSION_TOKEN),window.localStorage.removeItem(n.PUBLISHABLE_KEY),window.localStorage.removeItem(n.REDIRECT_URI),window.localStorage.removeItem(n.PROPOSAL_ID),window.localStorage.removeItem(n.DEFAULT_RANGE),window.localStorage.removeItem(n.ADDRESSES),window.localStorage.removeItem(n.MERCHANT),window.localStorage.removeItem(n.HUB),f({success:!0})):f({success:!1,text:e.text})}):f({success:!1,text:e.jqXHR})})}else f(i)})):f({success:!1,text:n.ERROR.BAD_REQUEST_400,errorMessage:"You need to set required fields before."})}}),r("milkman",["require","jquery","milkman/commit","milkman/Utils/defaults","milkman/Utils/constants","milkman/Private/checkInterval","milkman/Private/checkMissingDates","milkman/Private/priceEngine","milkman/Private/checkProposal","milkman/Private/recoverData","milkman/Private/rangeNormalization","milkman/Entities/createEntity","milkman/Entities/deleteEntity","milkman/Entities/setEntity","milkman/Entities/getEntities","milkman/Public/setInit","milkman/Public/setAddress","milkman/Public/getQuote","milkman/Public/findQuote","milkman/Public/confirm"],function(e){"use strict";var t=e("jquery"),n=e("milkman/commit"),r=e("milkman/Utils/defaults"),i=e("milkman/Utils/constants"),s=e("milkman/Private/checkInterval"),o=e("milkman/Private/checkMissingDates"),u=e("milkman/Private/priceEngine"),a=e("milkman/Private/checkProposal"),f=e("milkman/Private/recoverData"),l=e("milkman/Private/rangeNormalization"),c=e("milkman/Entities/createEntity"),h=e("milkman/Entities/deleteEntity"),p=e("milkman/Entities/setEntity"),d=e("milkman/Entities/getEntities"),v=e("milkman/Public/setInit"),m=e("milkman/Public/setAddress"),g=e("milkman/Public/getQuote"),y=e("milkman/Public/findQuote"),b=e("milkman/Public/confirm");return{version:"0.0.1, jQuery version is: "+t.fn.jquery,checkInterval:s,checkMissingDates:o,commit:n,defaults:r,constants:i,priceEngine:u,checkProposal:a,recoverData:f,rangeNormalization:l,createEntity:c,deleteEntity:h,setEntity:p,getEntities:d,setInit:v,setAddress:m,getQuote:g,findQuote:y,confirm:b}}),r("jquery",function(){return e}),n("milkman")});